# 计算机原理

### 计算机发展简史

1. 1946～1957: 电子管计算机
2. 1957～1964: 晶体管计算机
3. 1964～1980: 集成电路计算机
4. 1980～现在: 超大规模集成电路计算机

### 计算机的体系与结构

#### 冯诺依曼体系

存储程序指令，设计通用电路

- 必须有一个存储器
- 必须有一个控制器
- 必须有一个运算器
- 必须有输入设备
- 必须有输出设备

CPU = 运算器 + 控制器

#### 现代计算机结构

CPU = 运算器 + 控制器 + 存储器

### 编程语言

- 编译型

    通过编译器把高级语言编译成低级语言，生成新的低级语言程序，也是计算机实际执行的语言

        C/C++
        Object-C
        Golang

- 解释型

    把高级语言作为输入，然后由低级语言编写的解释器进行等价的转换并执行，不会生成新的程序

        Python
        Php
        Javascript
    
- 混合型

    严格来说，Java程序通过编译器翻译成Java字节码文件，然后由JVM解释执行

### 计算机的层次

- 硬件逻辑层
- 微程序机器层
    
    微指令集

- 传统机器层

    CPU指令集（机器指令），存储在CPU的内部
- 操作系统层
- 汇编语言层

    汇编语言使用汇编器可以翻译成可直接执行的机器语言

- 高级语言层

- 应用层

### 计算机的计算单位

#### 容量单位
||bit|Byte|KB|MB|GB|TB|PB|EB|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|名字|比特位|字节|千字节|兆字节|吉字节|太字节|拍字节|艾字节|
|比例||8bits|1024B|1024KB|1024MB|1024GB|1024TB|1024PB|
|常见设备|门电路||寄存器|高速缓存|内存/硬盘|硬盘|云硬盘|数据仓库|

#### 速度单位

- 网络速度

    100M/s = 100Mbps = 100Mbit/s = (100/8)MB/s = 12.5MB/s

- CPU速度

    时钟频率，单位是赫兹（Hz）

        赫兹就是秒分之一，指每秒钟周期性变动重复次数的计量。例如蝴蝶的翅膀扇动的频率为15Hz

        2GHz = 2*1000^3Hz = 每秒20亿次

## 计算机组成

### 计算机的总线

#### 总线的分类

    用于连接计算机各个设备的一条线路

- 片内总线

    连接CPU内部设备的总线

- 系统总线

    - 数据总线
    
        一般与CPU位数相同（32位、64位）

        双向传输各个部件的数据信息

        数据总线的位数（总线宽度）是数据总线的重要参数

    - 地址总线

        指定源数据或目的数据在内存中的地址

        地址总线的位数与存储单元有关

    - 控制总线

        用来发出各种控制信号的传输线

        控制总线可以监视不同组件之间的状态（就绪/未就绪）

#### 总线的仲裁

    为了解决总线使用权的冲突问题


### 输入输出设备
#### 输入设备
- 字符输入设备
    - 薄膜键盘
    - 机械键盘  

        根据键盘的段落感、声音、压力、键程分为以下几类

        - 黑轴
        - 红轴
        - 青轴
        - 茶轴
    - 电容键盘
- 图形输入设备
    - 鼠标
    - 数位板
        - 输入板
        - 压感笔
    - 扫描仪

#### 输出设备
- 图像输出设备
    - 显示器
        - CRT显示器
        - 液晶显示器
    - 打印机
    - 投影仪

#### 输入输出设备与CPU的通信

- 程序中断

    是低速设备通知CPU的一种异步方式

- DMA（直接存储器访问）

    DMA 直接连接主存与 IO 设备

### 计算机存储器
#### 存储器的分类
- 按介质分类
    - 半导体存储器
        - 内存
        - U盘
        - 固态硬盘
    - 磁存储器
        - 磁带
        - 磁盘
- 按存取方式分类
    - 随机存储器（RAM）
    - 串行存储器
    - 只读存储器（ROM）
        - BIOS
#### 存储器的层次结构
- 缓存
    - 寄存器
    - 高速缓存
- 主存
    - 内存
- 辅存
    - 移动硬盘
    - U盘
 
 #### 主存储器
 - 内存（RAM）
    
    - 通过电容存储数据，必须隔一段时间刷新一次，如果断电，数据消失
    - 32位系统内存最大为 2^32 = 4 * 2^30 = 4GB
    - 64位系统内存最大为 2^64 = 2^32 * 2^30 = 2^34GB
#### 辅助存储器
- 磁盘
    - 组成

        由磁头、磁道、盘片等组成
    - 调度算法

#### 高速缓存
- 工作原理

    - 字：指存放在一个存储单元中的二进制代码组合（最小单位）

    - 字块：存储在连续的存储单元中而被看作是一个单元的一组字

    - 字的地址包含两部分

        1. 字块的地址
        2. 字在字块中的地址

    - 命中率

        是衡量缓存的重要性能指标

        访问缓存的次数占总访问次数（访问缓存的次数 + 访问主存的次数）的比值

    - 访问效率

- 替换策略
    - 随机算法
    - 先进先出算法（FIFO）
        - 把缓存当做一个队列，替换掉最先加入队列的字块
    - 最不经常使用算法（LFU）
        - 优先替换使用频率最少的字块
    - 最近少使用算法（LRU）
        - 优先淘汰一段时间内没有使用的字块
        - 一般使用双向链表实现

### 计算机的指令系统
#### 机器指令的形式

1. 操作码字段
    - 指明指令要完成的操作
    - 位数反映了机器的操作种类
2. 地址码字段
    - 指定数据的地址

#### 机器指令的操作类型
- 数据传输类型
- 算数逻辑操作
- 移位操作
- 控制指令
#### 机器指令的寻址方式
- 指令寻址
    1. 顺序寻址
    2. 跳跃寻址
- 数据寻址
    1. 立即寻址
        - 指令直接获得操作数
        - 无需访问存储器
    2. 直接寻址
        - 直接给出操作数在主存的地址
        - 寻找操作数简单，无需计算数据地址
    3. 间接寻址
        - 指令地址码给出的是操作数地址的地址
        - 需要访问一次或多次主存来获取操作数

|寻址方式|优点|缺点|
|:-:|:-:|:-:|
|立即寻址|速度快|地址码位数限制操作数表示范围|
|直接寻址|寻找操作数简单|地址码位数限制操作数表示范围|
|间接寻址|操作数表示范围大|速度慢|

#### 指令执行过程

## CPU组成
### 控制器
#### 程序计数器
- 用来存储下一条指令的地址
- 循环从程序计数器中拿出指令
- 当指令被拿出时，指向下一条指令
#### 时序发生器
- 发送时序脉冲
- CPU根据不同的时序脉冲有节奏的进行工作
- 类似节拍器
#### 指令译码器
- 翻译操作码对应的操作
- 控制传输地址码对应的数据
#### 寄存器
- 指令寄存器
    - 缓存主存或高速缓存中的计算机指令
- 主存地址寄存器
    - 保存当前CPU正要访问的内存单元的地址
- 主存数据寄存器
    - 保存当前CPU正要读或写的数据
- 通用寄存器
    - 用于暂时存放或传送数据或指令
    - 保存ALU的运算中间结果
    - 容量比专用寄存器要大
### 运算器

#### 数据缓冲器
#### ALU（算数逻辑单元）
#### 通用寄存器
- 痛控制器中的通用寄存器
#### 状态字寄存器
- 存放运算状态
- 存放运算控制信息







